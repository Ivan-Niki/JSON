
========= JSON: что это как с ним работать =========

JSON (JavaScript Object Notation) — стандартный текстовый формат для хранения и передачи структурированных 
данных. Он основан на синтаксисе объекта в JavaScript, но не привязан к нему. Работу с ним поддерживают многие 
современные языки программирования: Python, Java и другие.

Основа JSON — это синтаксис объектов JavaScript, которые используются в языке для представления данных. 
Данные в формате JSON хранятся как пары «ключ:значение» и упорядоченные списки.

Значениями в JSON могут быть:
-> JSON-объекты — неупорядоченные множества пар «ключ:значение», разделенные запятыми;
-> массивы — упорядоченные коллекции значений, заключенные в квадратные скобки, значения разделены запятыми;
-> числа — целые или с плавающей запятой;
-> логический тип данных (булевые значения) — true и false;
-> строки — заданные последовательности из символов Юникода (стандарт кодирования символов), заключенные в две двойные кавычки;
-> значение Null — показывает отсутствие информации.

----- Структура JSON -----
JSON-файл — это строка. Для работы с данными в этом формате нужно использовать методы глобального объекта JSON.
Синтаксис JSON повторяет синтаксис обычного объекта в JavaScript: данные записываются в виде пар «ключ — значение» и разделяются запятыми.
Ключи — строковые переменные, а значения могут быть строками, числами, булевыми значениями, объектами, 
массивами или null. Функции и даты в обычном JSON не поддерживаются.

Вот как выглядит простой JSON-файл:
//ключ    // значение
{
  "name": "John Smith",
  "age": 37
}

Чтобы отправить по сети объект JavaScript, его нужно преобразовать в JSON (строку). 
Для этого используется метод stringify(), который принимает объект в качестве параметра и возвращает строку JSON.

let student = {
name: ‘Max’,
age: 28,
isAdmin: false,
courses: [‘html’, ‘css’, ‘js’],
wife: null
};
let json = JSON.stringify(student);
alert(json);

/* выведет объект в формате JSON:
{
«name»: «Max»,
«age»: 28,
«isAdmin»: false,
«courses»: [«html», «css», «js»],
«wife»: null
}

*/

Для превращения данных, полученных в JSON-формате от сервера, в объект JavaScript применяется метод parse(). 
Он работает по аналогии со stringify(), принимая строку в качестве аргумента и возвращая объект.

Общие правила создания JSON-файла описывает RFC-стандарт:
-> данные записаны в виде пар «ключ:значение»;
-> данные разделены запятыми;
-> объект находится внутри фигурных скобок {};
-> массив находится внутри квадратных скобок [].

Есть и другие моменты:
-> В JSON-формате используют двойные кавычки (“), одиночные кавычки (‘) не подходят. Но кавычки не нужны для 
любых значений, не являющихся строкой, — чисел, массивов, булевых значений.
-> Одна лишняя или пропущенная запятая или скобка могут привести к сбою работы JSON-файла.
-> JSON-формат не поддерживает комментарии. Добавление комментария вызовет ошибку.
-> Автоматически сгенерированный JSON-файл не должен содержать ошибок, его лучше тоже проверить с помощью валидатора JSONLint.

--------- Объекты и массивы JSON ---------
Для хранения данных в JSON используются две структуры — объекты и массивы.

Объекты — неупорядоченная коллекция. Для них не принципиально в каком порядке следуют пары «ключ — значение». 
То есть их можно менять местами. Но будьте осторожны! Когда разработчик перемещает пару «ключ — значение» с 
любого места на последнюю, часто забывает удалить запятую, что приводит к ошибке.

Объект JSON очень похож на объект в JavaScript, но ключ всегда должен быть в кавычках. Например:

{
	"name": "Иван",
	"age": 34,
	"married": true
}

Массивы — упорядоченный список значений. Выглядят они так:

[
    "яблоко",
    "персик",
    "банан",
    "киви"
]

В отличие от объекта, порядок элементов в массиве важен. Тут нет ключей, поэтому обращаться к значениям мы можем 
только по индексу элемента. Важно помнить, что у первого элемента индекс 0.
Объекты и массивы могут быть вложены друг в друга, а количество уровней вложенности не ограничено.

--------- Что такое JSON5 ---------
JSON5 — это расширение стандарта JSON, повышающее читаемость и удобство написания JSON-данных. 
Кроме этого, он добавляет новые возможности, например использование комментариев, которых нет в самом стандарте.
Но важно помнить, что JSON5 поддерживается не всеми парсерами, приложениями и библиотеками, что пока 
ограничивает его использование.

Главные отличия JSON5, полезные в работе:

1) Допустимы комментарии:

{
// Это комментарий
}

2) Необязательно использовать кавычки для ключей, но только в том случае, если ключ состоит из букв, цифр или 
знаков подчёркивания и не является зарезервированным словом:

{ key: "value", // Ключ без кавычек
}

3) Есть специальный формат для дат и времени:

{ date: new Date(), // Значение-дата
}

4) Поддерживает многострочный текст, что позволяет записывать строки без неудобного экранирования:

{multiline: `Это
              многострочная
              строка`,}


----------- Что такое JSON Schema -----------

JSON Schema — это спецификация для описания структуры JSON-документов. Это можно представить как строгий 
контракт между клиентом и сервером. Как только ты начинаешь разрабатывать API, в один момент наступает полный 
бардак, если нет четких правил, что можно, а что нельзя отправлять в запросах или получать в ответах.


JSON Schema позволяет описать:
- Формат данных (числа, строки, объекты, массивы).
- Допустимые значения (минимумы, максимумы).
- Обязательные поля и необязательные.
- И много других классных вещей, которые спасут тебе кучу времени на дебаг.

Допустим, у нас есть обычный JSON-файл:

{
  "name": "John Doe",
  "age": 30,
  "address": {
    "city": "New York",
    "zip": "10001"
  }
}

Разработчик не знает, какие из этих полей являются обязательными, к какому типу данных могут принадлежать 
значения и так далее. JSON Schema позволяет добавить необходимые метаданные, или «правила» для этой информации, 
и описать, какие поля должны быть заполнены и что они могут содержать.
JSON Schema используется для валидации данных при обмене информацией между разными системами или при работе с 
данными, получаемыми от пользователей. Если новые данные не соответствуют заданной схеме, то разработчик быстро 
узнает об ошибке и сможет внимательно изучить информацию, исправив её или запросив обновление.

Благодаря этому код становится надёжным, предсказуемым и устойчивым к ошибкам, позволяя явно определять 
требования к представлению данных. Вот как будет выглядеть вышеупомянутый файл, описанный с помощью JSON Schema:

{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "properties": {
    "name": {
      "type": "string"
    },
    "age": {
      "type": "number"
    },
    "address": {
      "type": "object",
      "properties": {
        "city": {
          "type": "string"
        },
        "zip": {
          "type": "string"
        }
      },
      "required": ["city", "zip"]
    }
  },
  "required": ["name", "age", "address"]
}

Разберём код построчно:

- в первой строке указана ссылка на версию спецификации JSON Schema;
- данные должны быть объектом типа «object»;
- объект должен содержать три обязательных поля: «name», «age» и «address»;
- у каждого поля свой тип данных: «string» для имени, «number» для возраста и «object» для адреса;
- поле «address» должно быть объектом и содержать два обязательных подполя: «city» и «zip», которые относятся к строкам.

----------- Как работать с JSON -----------
Умение работать с JSON-файлами — один из базовых навыков для разработчиков, поскольку именно этот формат 
является стандартом для обмена данными в веб- и мобильных приложениях.

Как правило, работа с JSON сводится к двум действиям: сериализации и десериализации. Поговорим о них подробнее.
Сериализация — это преобразование данных из внутреннего формата, например из JavaScript-объекта, в формат JSON, 
который может быть отправлен на сервер. В большинстве языков программирования для этого есть встроенные функции 
или библиотеки. Например, в JavaScript преобразование объекта person в JSON-файл выглядит так:

const person = {
  name: 'John Doe',
  age: 30,
  address: {
    city: 'New York',
    zip: '10001'
  }
};

const jsonString = JSON.stringify(person); // Метод JSON.stringify преобразует объект person в JSON-формат

console.log(jsonString); // Выводит данные в консоль


Десериализация, наоборот, преобразует данные из формата JSON обратно во внутренний формат, с которым программист 
может работать в своём коде:

const jsonString = '{"name":"John Doe","age":30,"address":{"city":"New York","zip":"10001"}}';

const person = JSON.parse(jsonString); // Преобразуем JSON в объект person

console.log(person); // Выводит данные в консоль

